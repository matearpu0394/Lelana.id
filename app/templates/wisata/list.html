{% extends "layouts/base.html" %}

{% block title %}Daftar Wisata - MyApp.id{% endblock %}

{% block content %}
<div class="max-w-6xl mx-auto py-10 animate-[fadeInUp_0.3s_ease-out]">

  <h2 class="text-3xl font-bold text-gray-800 mb-6">Daftar Destinasi Wisata</h2>

  {% if current_user.is_authenticated and current_user.role == 'admin' %}
  <div class="mb-6">
    <a href="{{ url_for('wisata.tambah_wisata') }}"
       class="inline-block bg-primary hover:bg-primary/90 text-white px-5 py-2 rounded-lg font-medium shadow-sm transition">
       + Tambah Wisata Baru
    </a>
  </div>
  {% endif %}

  {% if daftar_wisata %}
  <div class="grid sm:grid-cols-2 lg:grid-cols-3 gap-6">
    {% for w in daftar_wisata %}
    <article class="bg-white border border-gray-100 rounded-xl shadow-sm hover:shadow-md transition p-5 flex flex-col justify-between">
      <div>
        <h3 class="text-xl font-semibold text-gray-800 mb-2">{{ w.nama }}</h3>
        <p class="text-sm text-gray-500 mb-3">
          <span class="font-medium text-gray-700">Kategori:</span> {{ w.kategori }} |
          <span class="font-medium text-gray-700">Lokasi:</span> {{ w.lokasi }}
        </p>
        <p class="text-gray-600 text-sm leading-relaxed mb-4">
          {{ w.deskripsi[:150] }}...
        </p>
      </div>

      <div class="mt-auto flex flex-wrap items-center gap-2 pt-3 border-t border-gray-100">
        <a href="{{ url_for('wisata.detail_wisata', id=w.id) }}"
           class="bg-primary/10 text-primary font-medium px-4 py-2 rounded-md hover:bg-primary/20 transition">
           Lihat Detail
        </a>

        {% if current_user.is_authenticated and current_user.role == 'admin' %}
        <a href="{{ url_for('wisata.edit_wisata', id=w.id) }}"
           class="bg-yellow-100 text-yellow-700 font-medium px-4 py-2 rounded-md hover:bg-yellow-200 transition">
           Edit
        </a>

        <form action="{{ url_for('wisata.hapus_wisata', id=w.id) }}"
              method="POST"
              class="inline"
              onsubmit="return confirm('Hapus data ini?');">
          {{ delete_form.hidden_tag() }}
          <button type="submit"
                  class="bg-red-100 text-red-600 font-medium px-4 py-2 rounded-md hover:bg-red-200 transition">
            Hapus
          </button>
        </form>
        {% endif %}
      </div>
    </article>
    {% endfor %}
  </div>
  {% else %}
  <p class="text-gray-500 italic mt-4">Belum ada data wisata.</p>
  {% endif %}

  <!-- Pagination -->
  {% if pagination.pages > 1 %}
  <div class="flex justify-center items-center gap-2 mt-10">
    {% if pagination.has_prev %}
    <a href="{{ url_for('wisata.list_wisata', page=pagination.prev_num) }}"
       class="px-3 py-1 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-100 transition">
      &laquo; Sebelumnya
    </a>
    {% endif %}

    {% for page_num in pagination.iter_pages() %}
      {% if page_num %}
        {% if page_num != pagination.page %}
        <a href="{{ url_for('wisata.list_wisata', page=page_num) }}"
           class="px-3 py-1 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-100 transition">
           {{ page_num }}
        </a>
        {% else %}
        <span class="px-3 py-1 bg-primary text-white rounded-md font-semibold">{{ page_num }}</span>
        {% endif %}
      {% else %}
      <span class="px-3 py-1 text-gray-400">...</span>
      {% endif %}
    {% endfor %}

    {% if pagination.has_next %}
    <a href="{{ url_for('wisata.list_wisata', page=pagination.next_num) }}"
       class="px-3 py-1 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-100 transition">
      Selanjutnya &raquo;
    </a>
    {% endif %}
  </div>
  {% endif %}
</div>
{% endblock %}