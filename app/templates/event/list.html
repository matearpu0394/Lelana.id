{% extends "layouts/base.html" %}

{% block title %}Daftar Event - Lelana.id{% endblock %}

{% block content %}
<div class="max-w-5xl mx-auto mt-10">
  <h2 class="text-3xl font-semibold text-gray-800 mb-6">Daftar Event Lokal</h2>

  {% if current_user.is_authenticated and current_user.role == 'admin' %}
  <div class="mb-6">
    <a href="{{ url_for('event.tambah_event') }}"
       class="inline-flex items-center bg-[#13B782] text-white px-4 py-2 rounded-lg shadow hover:bg-[#10a072] transition">
       + Tambah Event Baru
    </a>
  </div>
  {% endif %}

  <div class="space-y-6">
    {% for e in daftar_event %}
    <article class="border border-gray-200 rounded-lg p-6 shadow-sm hover:shadow-md transition">
      <h3 class="text-2xl font-semibold text-gray-800 mb-2">{{ e.nama }}</h3>
      <p class="text-gray-600 mb-3">
        <strong class="text-gray-900">Tanggal:</strong> {{ e.tanggal.strftime('%d %B %Y') }} &nbsp;|&nbsp;
        <strong class="text-gray-900">Lokasi:</strong> {{ e.lokasi }}
      </p>
      <p class="text-gray-700">{{ e.deskripsi[:150] }}...</p>

      <div class="flex flex-wrap items-center gap-3 mt-5">
        <a href="{{ url_for('event.detail_event', id=e.id) }}"
           class="px-4 py-2 bg-[#13B782] text-white rounded-lg hover:bg-[#10a072] transition">
           Lihat Detail
        </a>

        {% if current_user.is_authenticated and current_user.role == 'admin' %}
        <a href="{{ url_for('event.edit_event', id=e.id) }}"
           class="px-4 py-2 bg-yellow-400 text-black rounded-lg hover:bg-yellow-500 transition">
           Edit
        </a>
        <form action="{{ url_for('event.hapus_event', id=e.id) }}" method="POST"
              class="inline" onsubmit="return confirm('Hapus event ini?');">
          {{ delete_form.hidden_tag() }}
          <button type="submit"
                  class="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition">
            Hapus
          </button>
        </form>
        {% endif %}
      </div>
    </article>
    {% else %}
    <p class="text-gray-500 text-center py-8 border rounded-lg bg-gray-50">Belum ada data event.</p>
    {% endfor %}
  </div>

  <!-- Pagination -->
  <div class="flex justify-center items-center gap-2 mt-8 text-gray-700">
    {% if pagination.has_prev %}
    <a href="{{ url_for('event.list_event', page=pagination.prev_num) }}"
       class="px-3 py-1 border rounded hover:bg-gray-100">&laquo; Sebelumnya</a>
    {% endif %}

    {% for page_num in pagination.iter_pages() %}
      {% if page_num %}
        {% if page_num != pagination.page %}
        <a href="{{ url_for('event.list_event', page=page_num) }}"
           class="px-3 py-1 border rounded hover:bg-gray-100">{{ page_num }}</a>
        {% else %}
        <strong class="px-3 py-1 bg-[#13B782] text-white rounded">{{ page_num }}</strong>
        {% endif %}
      {% else %}
      <span>...</span>
      {% endif %}
    {% endfor %}

    {% if pagination.has_next %}
    <a href="{{ url_for('event.list_event', page=pagination.next_num) }}"
       class="px-3 py-1 border rounded hover:bg-gray-100">Selanjutnya &raquo;</a>
    {% endif %}
  </div>
</div>
{% endblock %}