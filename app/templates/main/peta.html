{% extends "layouts/base.html" %}

{% block title %}Peta Wisata - Lelana.id{% endblock %}

{% block content %}
<div class="max-w-6xl mx-auto py-8 animate-[fadeInUp_0.3s_ease-out]">
  <!-- Judul halaman -->
  <h2 class="text-2xl font-bold text-gray-800 mb-2 border-b-2 border-primary pb-2">
    üó∫Ô∏è Peta Interaktif Destinasi Wisata
  </h2>
  <p class="text-gray-600 mb-6">
    Temukan berbagai lokasi wisata menarik di Banyumas dan sekitarnya.
  </p>

  <!-- Container Peta -->
  <div class="bg-white rounded-xl shadow-md border border-gray-100 overflow-hidden">
    <div id="map" class="w-full h-[500px]"></div>
  </div>

</div>
{% endblock %}

{% block scripts %}
<script>
  // Inisialisasi peta
  const map = L.map('map').setView([56.1304, -106.3468], 5); // posisi default Kanada

  // Lapisan dasar OpenStreetMap
  L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
      maxZoom: 19,
      attribution: '&copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a>'
  }).addTo(map);

  // Ambil data wisata dari API Flask
  fetch('{{ url_for("wisata.api_lokasi_wisata") }}')
    .then(response => response.json())
    .then(data => {
      data.forEach(lokasi => {
        const marker = L.marker([lokasi.lat, lokasi.lon]).addTo(map);
        marker.bindPopup(`
          <div class="text-sm">
            <b><a href="${lokasi.detail_url}" class="text-primary hover:underline">${lokasi.nama}</a></b>
          </div>
        `);
      });
    })
    .catch(error => console.error('Error:', error));
</script>
{% endblock %}